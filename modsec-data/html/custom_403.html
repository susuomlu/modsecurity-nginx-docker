<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Access Denied - 403 Forbidden</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">
    <div class="max-w-md w-full bg-white p-8 rounded-xl shadow-2xl border-2 border-red-500">
        <div class="text-center">
            <h1 class="text-6xl font-extrabold text-red-600 mb-4">403</h1>
            <h2 class="text-3xl font-bold text-gray-800 mb-6">ðŸš« Access Blocked by WAF</h2>
        </div>
        <p class="text-gray-600 mb-6 text-center">
            Your request was flagged as a security risk and has been blocked by our Web Application Firewall.
            This action protects the system from potential attacks.
        </p>
        <div class="bg-red-50 p-4 rounded-lg border border-red-200 mb-4">
            <div class="text-sm font-semibold text-gray-700 mb-2">Reference ID:</div>
            <div id="reference-id" class="text-xl font-mono text-red-700 break-all bg-white p-2 rounded">
                <!--# echo var="msec" -->-<!--# echo var="remote_addr" -->
            </div>
        </div>
        <div class="bg-gray-50 p-4 rounded-lg border border-gray-200">
            <div class="text-sm font-semibold text-gray-700 mb-2">Your IP Address:</div>
            <div id="client-ip" class="text-lg font-mono text-gray-800 break-all bg-white p-2 rounded">
                <!--# echo var="remote_addr" default="Not Available" -->
            </div>
        </div>
        <div class="bg-gray-50 p-4 rounded-lg border border-gray-200 mt-4">
            <div class="text-sm font-semibold text-gray-700 mb-2">Request Details:</div>
            <div class="text-sm font-mono text-gray-800 bg-white p-2 rounded space-y-1">
                <div><span class="text-gray-600">Time:</span> <!--# echo var="time_local" --></div>
                <div><span class="text-gray-600">URI:</span> <!--# echo var="request_uri" --></div>
            </div>
        </div>
        <p class="text-xs text-gray-500 mt-4 text-center">
            If you believe this is an error, please provide the Reference ID, IP address, and timestamp to the administrator. The administrator can correlate this with ModSecurity audit logs using the timestamp and IP.
        </p>
    </div>
</body>
</html>
